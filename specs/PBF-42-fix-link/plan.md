# Implementation Plan: Fix Navigation Links

**Branch**: `PBF-42-fix-link` | **Date**: 2025-12-21 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/PBF-42-fix-link/spec.md`

## Summary

CTA buttons (e.g., "Explore Projects" on hero section) and internal navigation links use plain anchor navigation (`<a href="#section">`) instead of the TUI navigation handler. This causes blank screens on desktop when the browser hash navigation conflicts with the CSS-based horizontal slide animation system. The fix extends `setupClickHandlers()` to include all internal anchor links with hash references, applying the same pattern from PBF-37 that fixed sidebar/tabs navigation.

## Technical Context

**Language/Version**: TypeScript 5.9+ (Astro 5.15.3 components)
**Primary Dependencies**: Astro, GSAP 3.13.0 (for other animations, not navigation), Lenis 1.0.42 (smooth scroll)
**Storage**: N/A (static site, no data persistence)
**Testing**: Bun test runner (Jest-compatible API) - `tests/unit/`, `tests/integration/`
**Target Platform**: Web (GitHub Pages) - Desktop ≥1024px, Mobile <1024px
**Project Type**: Single static web application
**Performance Goals**: 60fps animations, LCP <2.5s, TTI <3s on 3G
**Constraints**: 0KB initial JS via Astro Islands, CSS transitions max 0.4s
**Scale/Scope**: 6 sections single-page portfolio, ~10 navigation trigger points

**Affected Files**:
- `src/scripts/tui-navigation.ts` - Add generic internal link click handlers (~15 lines)

**Root Cause Analysis**:
- `setupClickHandlers()` (line 236-250) only selects `.tui-file-entry` and `.tui-buffer-tab`
- Hero CTA is `<a href="#projects" class="tui-hero__cta">` - no `data-section-id`, not selected
- Browser default anchor behavior triggers hash change without animation state sync
- CSS `is-active`/`is-previous` classes never applied, causing blank screen

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Compliance | Notes |
|-----------|------------|-------|
| **I. Performance First** | ✅ PASS | No new JS bundle size; reusing existing navigation handler |
| **II. Quality & Accessibility** | ✅ PASS | Maintains keyboard navigation, adds consistent behavior |
| **III. Build & Deployment** | ✅ PASS | No build process changes |
| **IV. Developer Experience** | ✅ PASS | Follows existing component patterns |
| **V. Content & SEO** | ✅ PASS | No content/SEO impact |
| **VI. Tooling & Runtime** | ✅ PASS | Using Bun for all operations |

**Performance Budget Impact**: Zero - reusing existing code, no new dependencies

**Accessibility Checklist**:
- ✅ Graceful degradation: links fallback to browser hash navigation if JS fails
- ✅ Keyboard navigation: Enter/Space already triggers click events
- ✅ Reduced motion: existing `prefersReducedMotion` check applies

## Project Structure

### Documentation (this feature)

```
specs/PBF-42-fix-link/
├── spec.md              # Feature specification
├── plan.md              # This file
├── research.md          # Phase 0 output
├── quickstart.md        # Phase 1 output
└── tasks.md             # Phase 2 output (generated by /speckit.tasks)
```

### Source Code (affected files only)

```
src/
└── scripts/
    └── tui-navigation.ts    # Add generic internal link handler to setupClickHandlers()
```

**Structure Decision**: This is a minimal bug fix affecting a single file. The fix extends `setupClickHandlers()` with a generic handler for all internal hash links (`a[href^="#"]`), automatically capturing CTA buttons and any future internal links without modifying component files.

## Complexity Tracking

*No constitution violations - fix uses existing patterns and infrastructure.*
