---
/**
 * ScrollProgress Component
 * Feature: 008-title-scroll-progress
 *
 * Visual indicator showing page scroll progress from top to bottom.
 * Fixed at top of viewport with violet/rose gradient fill.
 */

export interface Props {
	/** Z-index for the progress bar (default: 9999 to appear above header) */
	zIndex?: number;
}

const { zIndex = 9999 } = Astro.props;
---

<div
	id="scroll-progress"
	class="scroll-progress"
	style={`z-index: ${zIndex};`}
	role="progressbar"
	aria-label="Page scroll progress"
	aria-valuemin="0"
	aria-valuemax="100"
	aria-valuenow="0"
>
	<div class="scroll-progress__bar"></div>
</div>

<style>
	.scroll-progress {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 4px;
		background-color: transparent;
		pointer-events: none;
		/* z-index set via inline style for configurability */
	}

	.scroll-progress__bar {
		height: 100%;
		width: 0%;
		background: linear-gradient(
			90deg,
			var(--color-primary) 0%,
			var(--color-secondary) 100%
		);
		transition: width 0.1s ease-out;
		transform-origin: left center;
	}

	/* Respect reduced motion preference */
	@media (prefers-reduced-motion: reduce) {
		.scroll-progress__bar {
			transition: none;
		}
	}

	/* Enhance visibility on high-DPI displays */
	@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
		.scroll-progress {
			height: 3px;
		}
	}
</style>

<script>
	import { initScrollProgress } from "../../scripts/scroll-progress";

	// Initialize scroll progress tracking
	initScrollProgress();

	// Cleanup on page navigation (Astro view transitions)
	document.addEventListener("astro:before-swap", () => {
		// Cleanup will be handled by destroyScrollProgress if needed
	});
</script>
