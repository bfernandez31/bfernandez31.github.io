---
import BaseLayout from "./BaseLayout.astro";
import BurgerMenu from "../components/layout/BurgerMenu.astro";
import Footer from "../components/layout/Footer.astro";
import ScrollProgress from "../components/ui/ScrollProgress.astro";
import CustomCursor from "../components/ui/CustomCursor.astro";

export interface Props {
	title: string;
	description?: string;
	ogImage?: string;
	noindex?: boolean;
	canonicalUrl?: string;
}

const { title, description, ogImage, noindex, canonicalUrl } = Astro.props;
---

<BaseLayout
	title={title}
	description={description}
	ogImage={ogImage}
	noindex={noindex}
	canonicalUrl={canonicalUrl}
>
	<CustomCursor />
	<ScrollProgress />
	<BurgerMenu />
	<main>
		<slot />
	</main>
	<Footer />
</BaseLayout>

<script>
	import { detectDeviceTier } from '../scripts/performance/device-tier';

	// Detect device tier on page load (before other scripts)
	const deviceTierResult = detectDeviceTier();
	console.log('Device Tier:', deviceTierResult.tier);
	console.log('Reasons:', deviceTierResult.reasons);
	console.log('Capabilities:', deviceTierResult.capabilities);

	// Store globally for other scripts to access
	(window as any).__DEVICE_TIER__ = deviceTierResult;

	// Expose as CSS custom property for styling-based optimizations
	document.documentElement.style.setProperty('--device-tier', deviceTierResult.tier.toLowerCase());
</script>

<style>
	main {
		min-height: 100vh;
	}
</style>
